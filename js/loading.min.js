(function() {
	var loader = document.getElementById("loader");
	var config = [{
		button: document.getElementById("loader-ball-shadow"),
		className: "loader-ball",
		attributes: [{
			attribute: "shadow"
		}]
	}];
	
	/* 再点击一下取消效果
	var timer;
	loader.addEventListener("click", function() {
		for (var i = this.attributes.length - 1; i >= 0; i--) {
			if (this.attributes[i].name !== "id") {
				this.removeAttribute(this.attributes[i].name)
			}
		}
		clearTimeout(timer)
	});
	*/
	for (var i = 0; i < config.length; i++) {
		(function(i) {
			config[i]["button"].addEventListener("click", function() {
				if (config[i]["attributes"]) {
					for (var j = 0; j < config[i]["attributes"].length; j++) {
						var tempAttribute = config[i]["attributes"][j];
						var tempValue = tempAttribute["value"] ? tempAttribute["value"].value : "";
						loader.setAttribute(tempAttribute["attribute"], tempValue)
					}
				}
				loader.classList.add("loader", config[i]["className"], "is-active");
				hideLoader(config[i]["className"], config[i]["attributes"] ? config[i]["attributes"] : [])
			})
		})(i)
	}

	function hideLoader(param, attr) {
		var timer = setTimeout(function() {
			loader.classList.remove("is-active", param, "loader");
			for (var k = 0; k < attr.length; k++) {
				loader.removeAttribute(attr[k]["attribute"])
			}
			window.location.href = "./main.html"
		}, 4000)
	}
	
	/*跳转到某个锚链接点
	if (window.location.hash) {
		var loaderHash = window.location.hash.split("/#")[1];
		var event = document.createEvent("HTMLEvents");
		event.initEvent("click", true, false);
		document.getElementById(loaderHash).dispatchEvent(event);
		setTimeout(function() {
			history.pushState("", document.title, window.location.pathname)
		}, 6000)
	}
	*/
})();